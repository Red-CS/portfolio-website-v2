---
import { FiGithub, FiExternalLink } from 'react-icons/fi'
import type { ProjectType } from '@schemas'
import Icon from './Icon.astro'
import { Image } from 'astro:assets'

const isNonEmpty = (str: string | undefined) => {
  if (str === undefined) return false
  return str.trim().length !== 0
}

interface Props {
  project: ProjectType
}

const { project } = Astro.props
---

<li class='project-container'>
  <div class='content-wrapper'>
    <p class='featured'>Featured</p>
    <div class='project-header'>
      <h3 class='title'>{project.title}</h3>
      <div class='gradient-line'></div>
    </div>
    <p class='description'>{project.description}</p>
    <ul class='technologies'>
      {
        project.technologies.map((tech) => {
          return <li>{tech}</li>
        })
      }
    </ul>
    {/* Github link + icon */}
    {
      isNonEmpty(project.links.github) && (
        <Icon href={project.links.github || '#'} style={{ marginRight: '10px' }}>
          <FiGithub className='icon' style={{ scale: '1.2' }} />
        </Icon>
      )
    }

    {/* Project link + icon */}
    {
      isNonEmpty(project.links.project_url) && (
        <Icon href={project.links.project_url || '#'}>
          <FiExternalLink className='icon' style={{ scale: '1.3' }} />
        </Icon>
      )
    }
  </div>

  <div class='thumbnail-wrapper'>
    <div class='img-screen'>
      <Image
        src={project.image_url}
        alt={`Thumbnail image describing the ${project.title} project `}
        width={500}
        height={500}
        class='thumbnail'
      />
    </div>
  </div>
</li>
<style lang='scss'>
  @use 'src/main' as *;

  $border-radius: 10px;

  .project-container {
    position: relative;
  }

  .thumbnail-wrapper {
    position: absolute;
    inset: 0;
    max-width: 100%;

    .img-screen {
      content: '';
      position: absolute;
      width: 100%;
      height: 100%;

      &::before {
        content: '';
        position: absolute;
        width: 100%;
        height: 100%;
        background: var(--gradient);
        mix-blend-mode: screen;
        opacity: 0.1;
        z-index: 1;
        border-radius: $border-radius;
        filter: grayscale(35%) contrast(1) brightness(100%);
      }
    }

    img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: center center;
      opacity: 0.2;
      mix-blend-mode: screen;
      border-radius: $border-radius;
    }
  }

  .content-wrapper {
    padding: 20px;

    .featured {
      font-family: var(--font-mono);
      color: var(--text-gray-light);
      background: var(--gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-size: 0.8rem;
    }

    .project-header {
      display: flex;
    }

    .title {
      font-size: 1.1rem;
      margin-bottom: 1rem;
      font-weight: 500;
      color: var(--text-main);
      display: inline-block;
      position: relative;
    }

    .gradient-line {
      height: 4px;
      width: max-content;
      background: var(--gradient);
    }

    .description {
      font-size: 0.9rem;
      margin-bottom: 7px;
      line-height: 1.8;
    }

    .technologies {
      display: flex;
      color: var(--text-gray-light);
      column-gap: 1rem;
      font-size: 0.9rem;
    }
  }
</style>
