---
import type { TReport } from '@schemas'
import { TbPencilCode } from 'react-icons/tb'
import { Icon } from '@components'

interface Props {
  report: TReport
}

const { report } = Astro.props

const monthTable: Record<string, string> = {
  '01': 'January',
  '02': 'February',
  '03': 'March',
  '04': 'April',
  '05': 'May',
  '06': 'June',
  '07': 'July',
  '08': 'August',
  '09': 'September',
  '10': 'October',
  '11': 'November',
  '12': 'December'
}

const dateComponents: (string | number)[] = report.date_published.split('-')

// Transform month
dateComponents[1] = monthTable[dateComponents[1]]

// Transform day
dateComponents[2] = parseInt(dateComponents[2] as string)
---

<li class='report-container'>
  <a href='/reports/'>
    <div class='content'>
      <Icon style={{ pointerEvents: 'none', cursor: 'default' }}>
        <TbPencilCode className='icon' style={{ scale: '2', strokeWidth: '1.3' }} />
      </Icon>
      <h4>{report.title}</h4>
      <p>{report.description}</p>
    </div>
    <div class='metadata'>
      <span>{report.read_time} min read</span>
      <span>{dateComponents[1]} {dateComponents[2]}, {dateComponents[0]}</span>
    </div>
  </a>
</li>
<script>
  // Apply Icon gradient on container hover, instead of icon hover

  const reportComponents = Array.from(document.querySelectorAll('.report-container'))
  reportComponents.forEach((report, index) => {
    // Give each report an index
    report.id = 'report-' + index

    // Add styles for the gradient
    const hoverOnContainerStyles = document.createElement('style')
    hoverOnContainerStyles.innerHTML = `
      .report-container:hover stop:first-child {
        stop-color: var(--gradient-start);
      }

      .report-container:hover stop:last-child {
        stop-color: var(--gradient-end);
      }
    
    `
    report.appendChild(hoverOnContainerStyles)
  })
</script>
<style lang='scss'>
  .report-container {
    background-color: #191919;
    padding: 20px;
    border-radius: 10px;
    transition: 0.5s ease;

    a {
      min-height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    &:hover,
    &:focus {
      transform: translateY(-6px);
    }
  }

  h4 {
    font-size: 1.1rem;
    color: var(--text-main);
    margin: 2rem 0;
    font-weight: 500;
  }

  p {
    font-size: 0.9rem;
    margin-bottom: 7px;
  }

  .metadata {
    color: var(--text-gray-dark);
    margin: 10px 0;
    display: flex;
    justify-content: space-between;
    font-family: var(--font-mono);
    font-size: 0.9rem;
  }
</style>
