<slot />
<script>
  import { getGradient } from '@util'

  const icons = Array.from(
    // eslint-disable-next-line no-undef
    document.getElementsByClassName('aside-social') as HTMLCollectionOf<HTMLElement>
  )
  icons.forEach((icon, index) => {
    const svg = icon.closest('svg')
    console.log(svg)
    console.log(index)
    svg.id = 'icon-' + index
    const domId = svg.id

    const [color1, color2] = getGradient()

    const id = 'gradient-' + index
    const defsElement = document.createElementNS('http://www.w3.org/2000/svg', 'defs')

    const linearGradient = document.createElementNS('http://www.w3.org/2000/svg', 'linearGradient')
    linearGradient.setAttribute('id', id)
    linearGradient.setAttribute('x1', '100%')
    linearGradient.setAttribute('y1', '0%')
    linearGradient.setAttribute('x2', '0%')
    linearGradient.setAttribute('y2', '100%')

    const stop1 = document.createElementNS('http://www.w3.org/2000/svg', 'stop')
    stop1.setAttribute('offset', '0%')
    stop1.setAttribute('stop-color', 'var(--text-gray-light')

    const stop2 = document.createElementNS('http://www.w3.org/2000/svg', 'stop')
    stop2.setAttribute('offset', '100%')
    stop2.setAttribute('stop-color', 'var(--text-gray-light')

    linearGradient.appendChild(stop1)
    linearGradient.appendChild(stop2)

    defsElement.appendChild(linearGradient)

    svg.insertBefore(defsElement, svg.firstChild)

    let prefix: 'fill' | 'stroke'
    getComputedStyle(svg).getPropertyValue('stroke-width') === '0px'
      ? // Apply to fill (Spotify, X/Twitter, Discord)
        (prefix = 'fill')
      : // Apply to stroke (Instagram, Github, LinkedIn)
        (prefix = 'stroke')

    //const liParent = svg.closest('li')
    const hoverStyles = document.createElement('style')

    hoverStyles.innerHTML = `
    #${domId} {
      ${prefix}: url(#${id});
    }

    #${domId} stop {
      transition: 1s ease;
    }

    #${domId}:hover stop:first-child {
      stop-color: ${color1};
    }
    #${domId}:hover stop:last-child {
      stop-color: ${color2};
    }
      `
    svg.appendChild(hoverStyles)
  })
</script>
